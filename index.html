<!doctype html>
<html>
    <head>
        <link rel="stylesheet" href="css/bootflat.css">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta charset="utf-8">
        <title>_zorpg</title>

        <style>
            textarea{width:100%}
            /*body{background-color:#000}
            .container{background-color:#333; color:#fff} */
        </style>
    </head>

    <body>
        <div class="container">
            <h4>_zorpg</h4>
            <div id="game"></div>
            <hr />
            <canvas id="3d" style="width: 600px;height: 480px"></canvas>
        </div>

        <script src="js/jquery.js"></script>
        <script src="js/bootflat.js"></script>
        <script src="js/babylon31.js"></script>
        <!-- <script src="js/babylon-gui.js"></script> -->
        <script type="text/javascript" src="js/game.js"></script>

        <script>

        // Init states
        ZORPG.State.add("load", {
            init: function() {
                console.log("ZORPG.State: Loading...");
                ZORPG.Canvas.init();

                ZORPG.Loader.addTextFileTask("map", "maps/map1.json");
                ZORPG.Loader.addImageTask("splash", "img/splash.png");
                ZORPG.Loader.addImageTask("npc", "img/npc.png");
                ZORPG.Loader.onTasksDoneObservable.add(function() {
                    ZORPG.State.set("main_menu");
                });
                ZORPG.Loader.load();

            },
            destroy: function() {
                console.log("ZORPG.State: Loading finished.");
            }
        });

        ZORPG.State.add("main_menu", {
            name: "Main Menu",

            init: function() {
                console.log("ZORPG.State: Main menu.");

                var splash = new BABYLON.GUI.Image("splash", "img/splash.png");
                var button1 = BABYLON.GUI.Button.CreateSimpleButton("but1", "Click to Start");
                button1.width = "150px"
                button1.height = "40px";
                button1.color = "white";
                button1.cornerRadius = 20;
                button1.background = "green";
                button1.onPointerUpObservable.add(function() {
                    ZORPG.Canvas.GUI.removeControl(button1);
                    ZORPG.Canvas.GUI.removeControl(splash);
                    ZORPG.State.set("play");
                });

                ZORPG.Canvas.GUI.addControl(splash);
                ZORPG.Canvas.GUI.addControl(button1);
            },

            destroy: function() {}
        });

        ZORPG.State.add("play", {
            name: "Playing",

            init: function() {
                console.log("ZORPG.State: Playing.");
                var ground = BABYLON.Mesh.CreateGround("ground1", 6, 6, 2, ZORPG.Canvas.scene);
                var sphere = BABYLON.Mesh.CreateSphere("sphere1", 16, 2, ZORPG.Canvas.scene);
                sphere.position.y = 1;

                ZORPG.Key.add("Escape", function(ev) {
                    ZORPG.Canvas.clear();
                    ZORPG.Key.remove("Escape");
                    ZORPG.State.set("main_menu");
                });
            },

            destroy: function() {}
        });
        // Start
        ZORPG.State.set("load");
        </script>
    </body>
</html>